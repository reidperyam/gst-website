---
import BaseLayout from '../layouts/BaseLayout.astro';
import PortfolioHeader from '../components/portfolio/PortfolioHeader.astro';
import PortfolioControls from '../components/portfolio/PortfolioControls.astro';
import PortfolioGrid from '../components/portfolio/PortfolioGrid.astro';
import projects from '../data/projects.json';
import type { Project, Stat } from '../types/portfolio';

const typedProjects = projects as Project[];

// Calculate statistics
const totalProjects = typedProjects.length;
const totalArrNumeric = typedProjects.reduce((sum, p) => sum + (p.arrNumeric || 0), 0);
const totalArr = `$${(totalArrNumeric / 1000000000).toFixed(1)}B+`;
const uniqueIndustries = new Set(typedProjects.map(p => p.industry)).size;
const yearRange = `${Math.min(...typedProjects.map(p => p.year))}-${Math.max(...typedProjects.map(p => p.year))}`;

const stats: Stat[] = [
  { label: 'Projects', value: totalProjects.toString() },
  { label: 'Combined ARR', value: totalArr },
  { label: 'Industries', value: uniqueIndustries.toString() },
  { label: 'Global Markets', value: '12+' },
  { label: 'Portfolio Span', value: yearRange },
];
---

<BaseLayout
  title="Portfolio | Strategic Advisory & Implementation"
  description="Explore our track record of 51 strategic advisory and implementation projects across healthcare, logistics, software, finance, and more."
>
  <main>
    <PortfolioHeader stats={stats} />
    <PortfolioControls projects={typedProjects} />
    <PortfolioGrid projects={typedProjects} />
  </main>
</BaseLayout>

<style>
  main {
    min-height: 100vh;
  }
</style>
