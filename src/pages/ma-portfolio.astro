---
import BaseLayout from '../layouts/BaseLayout.astro';
import PortfolioHeader from '../components/portfolio/PortfolioHeader.astro';
import PortfolioGrid from '../components/portfolio/PortfolioGrid.astro';
import StickyControls from '../components/portfolio/StickyControls.astro';
import StatsBar from '../components/StatsBar.astro';
import PortfolioSummary from '../components/PortfolioSummary.astro';
import { trackPageView } from '../utils/analytics';
import projects from '../data/projects.json';
import type { Project, Stat } from '../types/portfolio';

// Track page view
trackPageView('ma-portfolio', 'M&A Portfolio | Strategic Advisory & Implementation');

const typedProjects = projects as Project[];

// Calculate statistics
const uniqueIndustries = new Set(typedProjects.map(p => p.industry)).size;
const minYear = Math.min(...typedProjects.map(p => p.year));
const maxYear = Math.max(...typedProjects.map(p => p.year));
const yearSpan = maxYear - minYear;

const stats: Stat[] = [
  { label: 'Combined ARR', value: '$2B+' },
  { label: 'Industries', value: uniqueIndustries.toString() },
  { label: 'Global Markets', value: '12+' },
  { label: 'Year Span', value: yearSpan.toString() },
];

// Pass the portfolio type to header
const portfolioType = 'ma';
---

<BaseLayout
  title="M&A Portfolio | Strategic Advisory & Implementation"
  description="Explore our track record of 51 M&A advisory and implementation projects across healthcare, logistics, software, finance, and more."
>
  <StickyControls projects={typedProjects} />
  <main>
    <PortfolioHeader portfolioType={portfolioType} projects={typedProjects} />
    <PortfolioSummary />
    <StatsBar stats={stats} />
    <PortfolioGrid projects={typedProjects} />
  </main>
</BaseLayout>

<style>
  main {
    min-height: 100vh;
  }
</style>
